name: AWS RDS available engine versions
description: List AWS RDS available engine versions and update the version file and push tags
inputs:
  engine:
    description: AWS RDS engine
    required: true
  region:
    description: AWS Region
    required: false
    default: us-east-1
  version_file:
    description: file path where versions are written
    required: false
    default: versions.txt
  github_token:
    description: GitHub Access Token
    required: true
  aws_access_key_id:
    description: AWS Access Key ID
    required: true
  aws_secret_access_key:
    description: AWS Secret Access Key
    required: true
runs:
  using: composite
  steps:
    - run: aws rds describe-db-engine-versions --region "${{ inputs.region }}" --engine "${{ inputs.engine }}" | jq -r ".DBEngineVersions[].EngineVersion" | uniq > "${{ inputs.version_file }}"
      shell: bash
      env:
        AWS_ACCESS_KEY_ID: ${{ inputs.aws_access_key_id }}
        AWS_SECRET_ACCESS_KEY: ${{ inputs.aws_secret_access_key }}
    - run: bash "${{ github.action_path }}/update.sh"
      shell: bash
      env:
        GITHUB_TOKEN: ${{ inputs.github_token }}
        VERSION_FILE: ${{ inputs.version_file }}
